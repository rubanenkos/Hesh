# Хеш-функція та пошук колізій

## Опис проекту

Цей проект реалізує власну хеш-функцію з виходом 2, 4 або 8 біт, яка задовольняє вимогу лавинного ефекту (зміна будь-якого байту змінює не менше 30% бітів результату), а також програму для автоматичного пошуку колізій.

## Структура проекту

- `hash_function.py` - реалізація хеш-функції з налаштовуваною довжиною виходу
- `hash_collision.py` - програма для автоматичного пошуку колізій
- `main.py` - головна програма для обчислення дайджестів та пошуку колізій
- `test_document.txt` - тестовий документ (Word-подібний текстовий файл)
- `test_source.py` - тестовий вихідний код на Python
- `test_image.png` - тестове зображення

## Хеш-функція

Хеш-функція реалізована в класі `CustomHash` і має наступні характеристики:

- **Довжина виходу**: 2, 4 або 8 біт (налаштовується)
- **Лавинний ефект**: зміна будь-якого байту змінює в середньому 47-49% бітів результату (перевищує вимогу 30%)
- **Алгоритм**: використовує комбінацію XOR операцій, бітових зсувів, множення та взаємодії зі станом

### Використання хеш-функції

```python
from hash_function import CustomHash

# Створення хеш-функції з виходом 8 біт
hash_func = CustomHash(output_bits=8)

# Хешування рядка
hash_value = hash_func.hash("Hello, World!")
print(f"Хеш: {hash_value}")

# Хешування файлу
hash_value = hash_func.hash_file("test.txt")
print(f"Хеш файлу: {hash_value}")

# Конвертація в різні формати
print(f"Двійкове: {hash_func.hash_to_binary(hash_value)}")
print(f"Шістнадцяткове: {hash_func.hash_to_hex(hash_value)}")
```

## Пошук колізій

Програма `hash_collision.py` містить клас `HashCollisionFinder` для автоматичного пошуку колізій.

### Методи пошуку колізій

1. **find_collision_bruteforce** - метод повного перебору
2. **find_collision_incremental** - поступова зміна оригінальних даних
3. **find_collision_smart** - розумний алгоритм з використанням різних стратегій змін

### Використання

```python
from hash_collision import HashCollisionFinder

finder = HashCollisionFinder(output_bits=8)

# Створення колізії для файлу
finder.create_collision_file(
    "original.txt",
    "collision.txt",
    max_attempts=100000
)
```

## Запуск програми

### Обчислення дайджестів та пошук колізій

```bash
python3 main.py
```

Програма:
1. Обчислює дайджести для всіх тестових файлів (2, 4, 8 біт)
2. Шукає колізії для кожного файлу
3. Створює файли-колізії з такими самими хешами

### Тестування хеш-функції

```bash
python3 hash_function.py
```

Виводить інформацію про хеш-функцію та тестує лавинний ефект.

## Результати

### Дайджести повідомлень (8 біт)

- **test_document.txt**: 81 (01010001, 0x51)
- **test_source.py**: 139 (10001011, 0x8b)
- **test_image.png**: 192 (11000000, 0xc0)

### Колізії

Для кожного файлу створені файли-колізії:
- `test_document_collision.txt`
- `test_source_collision.py`
- `test_image_collision.png`

Ці файли мають такий самий хеш, як оригінальні, але відрізняються вмістом, що демонструє вразливість коротких хеш-функцій.

## Висновки

1. **Хеш-функція задовольняє вимоги**: лавинний ефект перевищує 30% (близько 47-49%)

2. **Колізії легко знайти**: для коротких хеш-функцій (2, 4, 8 біт) колізії знаходяться дуже швидко:
   - 2 біти: 1-6 спроб
   - 4 біти: 9-35 спроб
   - 8 біт: 50-124 спроб

3. **Безпека залежить від довжини виходу**: чим коротший вихід, тим легше знайти колізії. Для практичного застосування потрібні хеш-функції з виходом 256+ біт (SHA-256, SHA-512).

## Технічні деталі

### Алгоритм хешування

1. Ініціалізація стану з фіксованими значеннями
2. Для кожного байту вхідних даних:
   - XOR з поточним станом
   - Бітові зсуви та множення
   - Взаємодія з масивом стану
   - Додаткове перемішування
3. Фінальне перемішування з усіма станами
4. Взяття модуля для отримання потрібної кількості бітів

### Стратегії пошуку колізій

- Випадкові зміни байтів
- XOR операції
- Обмін байтів місцями
- Комбінація різних методів

## Автор

Проект створено для демонстрації роботи хеш-функцій та пошуку колізій.

